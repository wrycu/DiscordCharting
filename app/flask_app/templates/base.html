
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
Hi!<br/>
Current games:<br/>
{% for game, players in current_games.items() %}
    {{ game }} - {{ players }} player(s)<br/>
{% endfor %}
<div id="top_games_by_play_time"></div>
<div id="top_games_by_user_count"></div>
<div id="top_active_time_of_day"></div>
<div id="game_user_count_over_time"></div>
<div id="total_games_played"></div>
<div id="top_active_users"></div>
<div id="user_contribution_to_total_game_time"></div>

<script>
$(function () {
    $.getJSON('{{ url_for('discord_charting.top_games_by_play_time') }}', function(data) {
        console.log(data);
        // Populate series
        $('#top_games_by_play_time').highcharts({
            chart: {
                type: 'column'
            },
            title: {
                text: 'Top 5 played games'
            },
            subtitle: {
                text: 'by combined gametime'
            },
            xAxis: {
                title: {
                    text: 'Game'
                }
            },
            yAxis: {
                title: {
                    text: 'Time in game'
                }
            },
            tooltip: {

            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: data
        });
    });
    $.getJSON('{{ url_for('discord_charting.top_games_by_user_count') }}', function(data) {
        console.log(data);
        // Populate series
        $('#top_games_by_user_count').highcharts({
            chart: {
                type: 'column'
            },
            title: {
                text: 'Top 5 played games'
            },
            subtitle: {
                text: 'by unique players'
            },
            xAxis: {
                title: {
                    text: 'Game'
                }
            },
            yAxis: {
                title: {
                    text: 'Users who have played game'
                }
            },
            tooltip: {

            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: data
        });
    });

     $.getJSON('{{ url_for('discord_charting.top_active_time_of_day') }}', function(data) {
        console.log(data);
        // Populate series
        $('#top_active_time_of_day').highcharts({
            chart: {
                type: 'column'
            },
            title: {
                text: 'Hourly Activity'
            },
            xAxis: {
                title: {
                    text: 'hour'
                }
            },
            yAxis: {
                title: {
                    text: 'Average Active users'
                }
            },
            tooltip: {

            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: data
        });
    });

    $.getJSON('{{ url_for('discord_charting.game_user_count_over_time') }}', function(data) {
        console.log(data);
        // Populate series
        $('#game_user_count_over_time').highcharts({
            title: {
                text: 'User Count/Game',
                x: -20 //center
            },
            subtitle: {
                text: 'over time',
                x: -20
            },
            xAxis: {
                categories: data['times']
            },
            yAxis: {
                title: {
                    text: '# of players'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
            tooltip: {
                valueSuffix: ' players'
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle',
                borderWidth: 0
            },
            series: data['games']
        });
    });

    $.getJSON('{{ url_for('discord_charting.total_games_played') }}', function(data) {
        console.log(data);
        // Populate series
        $('#total_games_played').highcharts({
            title: {
                text: 'Total unique games played',
                x: -20 //center
            },
            subtitle: {
                text: 'over time',
                x: -20
            },
            xAxis: {
                categories: data['times']
            },
            yAxis: {
                title: {
                    text: '# of unique games'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
            tooltip: {
                valueSuffix: ' games'
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle',
                borderWidth: 0
            },
            series: data['games']
        });
    });

    $.getJSON('{{ url_for('discord_charting.top_active_users') }}', function(data) {
        console.log(data);
        // Populate series
        $('#top_active_users').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            title: {
                text: 'Top 5 Active users'
            },
            subtitle: {
                text: 'contribution to top 5 users\' game time',
                x: -20
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                        style: {
                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                        }
                    }
                }
            },
            series: [{
                name: 'Top active users',
                colorByPoint: true,
                data: data
            }]
        });
    });

        $.getJSON('{{ url_for('discord_charting.user_contribution_to_total_game_time') }}', function(data) {
        console.log(data);
        // Populate series
        $('#user_contribution_to_total_game_time').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            title: {
                text: 'Top 5 Active users'
            },
            subtitle: {
                text: 'contribution to total game time',
                x: -20
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                        style: {
                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                        }
                    }
                }
            },
            series: [{
                name: 'Top active users',
                colorByPoint: true,
                data: data
            }]
        });
    });
});
</script>
</body>
</html>